<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pet Dudis</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f8f9fa;
}

/* Barra superior */
.top-bar {
  position: fixed;
  top: 0; left: 0; right: 0;
  height: 60px;
  background: linear-gradient(90deg, #6a1b9a, #43a047);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 20px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  z-index: 1000;
}

.logo {
  font-weight: bold;
  font-size: 18px;
  color: white;
  display: flex;
  align-items: center;
  gap: 8px;
}

.top-bar a {
  color: white;
  text-decoration: none;
  font-size: 15px;
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  border-radius: 6px;
  transition: background 0.3s;
}

.top-bar a:hover {
  background: rgba(255,255,255,0.2);
}

/* Dropdown perfil */
.profile-dropdown {
  position: relative;
  display: inline-block;
}

.profile-pic {
  width: 40px; height: 40px;
  border-radius: 50%;
  object-fit: cover;
  cursor: pointer;
  border: 2px solid white;
}

.dropdown-content {
  display: none;
  position: absolute;
  right: 0;
  background: white;
  min-width: 160px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  border-radius: 6px;
  overflow: hidden;
}

.dropdown-content a {
  display: block;
  padding: 10px;
  color: #333;
  text-decoration: none;
}

.dropdown-content a:hover {
  background: #f0f0f0;
}

.profile-dropdown:hover .dropdown-content {
  display: block;
}

/* Modal */
.modal {
  display: none;
  position: fixed;
  z-index: 2000;
  left: 0; top: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.5);
  align-items: center; justify-content: center;
}

.modal-content {
  background: white;
  padding: 20px;
  border-radius: 8px;
  width: 300px;
}

.modal-content h2 {
  margin-top: 0;
}

input, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border: 1px solid #ccc;
  border-radius: 5px;
}

button {
  background: #6a1b9a;
  color: white;
  border: none;
}

button:hover {
  background: #43a047;
}
</style>
</head>
<body>

<div class="top-bar">
  <div class="logo">
    <i class="fa-solid fa-paw"></i> Pet Dudis
  </div>
  <div id="user-area">
    <a href="#" id="loginBtn"><i class="fa-solid fa-user"></i> Entrar/Cadastrar</a>
  </div>
</div>

<div style="padding-top:80px;">
  <h1>Bem-vindo à Pet Dudis!</h1>
</div>

<!-- Modal Login -->
<div id="loginModal" class="modal">
  <div class="modal-content">
    <h2>Entrar</h2>
    <input type="email" id="loginEmail" placeholder="Email">
    <input type="password" id="loginSenha" placeholder="Senha">
    <button id="doLogin">Login</button>
    <p style="text-align:center;margin-top:10px;">Não tem conta? <a href="#" id="openRegister">Cadastre-se</a></p>
  </div>
</div>

<!-- Modal Cadastro -->
<div id="registerModal" class="modal">
  <div class="modal-content">
    <h2>Cadastrar</h2>
    <input type="text" id="registerNome" placeholder="Nome completo">
    <input type="email" id="registerEmail" placeholder="Email">
    <input type="password" id="registerSenha" placeholder="Senha">
    <button id="doRegister">Cadastrar</button>
    <p style="text-align:center;margin-top:10px;">Já tem conta? <a href="#" id="openLogin">Entrar</a></p>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_DOMINIO.firebaseapp.com",
  projectId: "SEU_PROJECT_ID",
  storageBucket: "SEU_BUCKET.appspot.com",
  messagingSenderId: "SEU_ID",
  appId: "SUA_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Modais
const loginModal = document.getElementById('loginModal');
const registerModal = document.getElementById('registerModal');
document.getElementById('loginBtn').onclick = () => loginModal.style.display = 'flex';
document.getElementById('openRegister').onclick = () => { loginModal.style.display = 'none'; registerModal.style.display = 'flex'; };
document.getElementById('openLogin').onclick = () => { registerModal.style.display = 'none'; loginModal.style.display = 'flex'; };
window.onclick = e => { if (e.target.classList.contains('modal')) e.target.style.display = 'none'; };

// Cadastro
document.getElementById('doRegister').onclick = async () => {
  const nome = document.getElementById('registerNome').value;
  const email = document.getElementById('registerEmail').value;
  const senha = document.getElementById('registerSenha').value;

  try {
    const cred = await auth.createUserWithEmailAndPassword(email, senha);
    await db.collection('usuarios').doc(cred.user.uid).set({
      nome: nome,
      email: email,
      perfil: 'cliente',
      foto: '',
      preferencias: {}
    });
    registerModal.style.display = 'none';
  } catch (err) {
    alert(err.message);
  }
};

// Login
document.getElementById('doLogin').onclick = async () => {
  const email = document.getElementById('loginEmail').value;
  const senha = document.getElementById('loginSenha').value;

  try {
    await auth.signInWithEmailAndPassword(email, senha);
    loginModal.style.display = 'none';
  } catch (err) {
    alert(err.message);
  }
};

// Estado de autenticação
auth.onAuthStateChanged(async user => {
  const userArea = document.getElementById('user-area');
  if (user) {
    const docUser = await db.collection('usuarios').doc(user.uid).get();
    if (docUser.exists) {
      const dados = docUser.data();
      if (dados.perfil === 'parceiro') {
        window.location.href = 'areadoparceiro.html';
        return;
      } else if (dados.perfil === 'funcionario') {
        window.location.href = 'painel-funcionario.html';
        return;
      }
      // cliente → permanece na página
      userArea.innerHTML = `
        <div class="profile-dropdown">
          <img src="${dados.foto || 'https://via.placeholder.com/40'}" class="profile-pic" />
          <div class="dropdown-content">
            <a href="#">Perfil</a>
            <a href="#" id="logoutBtn">Sair</a>
          </div>
        </div>
      `;
      document.getElementById('logoutBtn').onclick = () => auth.signOut();
    }
  } else {
    userArea.innerHTML = `<a href="#" id="loginBtn"><i class="fa-solid fa-user"></i> Entrar/Cadastrar</a>`;
    document.getElementById('loginBtn').onclick = () => loginModal.style.display = 'flex';
  }
});
</script>
</body>
</html>
